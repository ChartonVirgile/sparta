"SPARTA WWW Site"_sws - "SPARTA Documentation"_sd - "SPARTA Commands"_sc :c

:link(sws,http://sparta.sandia.gov)
:link(sd,Manual.html)
:link(sc,Section_commands.html#comm)

:line

fix dt command :h3

[Syntax:]

fix ID dt Nfreq avg_dt_weight transit_fraction collision_fraction lambda temperature usq vsq wsq mode extra :pre

ID is documented in "fix"_fix.html command :ulb,l
dt = style name of this fix command :l
Nfreq = perform timestep calculation every this many steps :l
avg_dt_weight = weight applied to average cell timestep when calculating the global timestep :l
transit_fraction = fraction of the cell transit time used to calculate a cell candidate timestep :l
collision_fraction = fraction of the cell mean collision time used to calculate a cell candidate timestep :l
lambda = compute or fix column for mean free path, prefaced by "c_" or "f_" :l
temperature = fix column for temperature, prefaced by "f_" :l
usq = fix column for x component of velocity squared, prefaced by "f_" :l
vsq = fix column for y component of velocity squared, prefaced by "f_" :l
wsq = fix column for z component of velocity squared, prefaced by "f_" :l
mode = {warn} or {use_calculated_dt} :l
extra = {store_cell_dt} (optional) :l
:ule

[Examples:]

fix DT dt 500 0.1 0.25 0.1 c_lambda f_1\[2\] f_1\[3\] f_1\[4\] f_1\[5\] warn
fix DT dt 500 0.1 0.25 0.1 f_lambda f_1\[2\] f_1\[3\] f_1\[4\] f_1\[5\] use_calculated_dt store_cell_dt :pre

These commands will calculate a global timestep every 500 steps, either 1) using the user-provided timestep
and warning if it is greater than the calculated timestep or 2) using the calculated timestep and
ignoring the user-provided value.

[Description:]

Calculate a global timestep based on cell mean collision and transit times. The user-suppled timestep is used prior to the
first invocation of this fix. Each time this fix is invoked, a candidate timestep is calculated in each cell, and then both an
average candidate timestep (dt_avg) and a minimum candidate timestep (dt_min) are computed over all cells.  The global timestep
is then determined using the formula:

dt_global = (1-avg_dt_weight)*dt_min + avg_dt_weight*dt_avg :pre

In the candidate timestep calculation for each cell, the mean collision time is multiplied by the user-supplied collision_fraction
described above to compute a timestep candidate.  Then for each coordinate direction, the cell size in that direction is
divided by the velocity magnitude in that direction and then multiplied by the user-supplied transit_fraction described above to
compute a timestep candidate.  The cell timestep is set to be the minumum of these candidate timesteps.  The collision and transit fractions
simply reduce the calculated timestep, providing a user-defined safety margin.

If specified in the <A HREF = "stats_style"_stats_style.html command, the calculated global timestep is printed.  A zero value
indicates that the fix has not yet calculated a global timestep and that the user-suppled timestep is being used.  If the fix has been
invoked, the last calculated value of the timestep will be displayed.  If the mode is set
to {warn}, the calculated timestep will be displayed but will not be used to advance the simulation.

[Example:]

stats_style     step cpu np f_DT :pre

:line

[Restart, output info:]

No information about this fix is written to "binary restart files"_restart.html.

The optional argument {store_cell_dt} directs the fix to store the cell timestep values in a per-grid vector.  The vector can be
accessed by any command that uses per-grid values from a fix as input.  For example, the values can be output by the
"dump grid"_dump.html command.  See "Section 4.4"_Section_howto.html#howto_4 for an overview of SPARTA
output options.  The {store_cell_dt} option could be useful for visualizing the cell timestep data on the grid at
a fixed point in time or as the solution evolves.
</P>
<P><B>Default: </B> none

